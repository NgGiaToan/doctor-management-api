2024-09-05 08:29:01.040 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 08:29:01.233 +07:00 [DBG] Hosting starting
2024-09-05 08:29:01.260 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 08:29:01.276 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 08:29:01.285 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 08:29:01.293 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 08:29:01.299 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 08:29:01.307 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 08:29:01.314 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:29:01.317 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 08:29:01.320 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:29:01.327 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 08:29:01.330 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 08:29:01.333 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 08:29:01.334 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 08:29:01.542 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 08:29:01.546 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 08:29:01.549 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 08:29:01.551 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 08:29:01.553 +07:00 [INF] Hosting environment: Development
2024-09-05 08:29:01.555 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 08:29:01.557 +07:00 [DBG] Hosting started
2024-09-05 08:29:07.139 +07:00 [INF] Application is shutting down...
2024-09-05 08:29:07.140 +07:00 [DBG] Hosting stopping
2024-09-05 08:29:07.157 +07:00 [DBG] Hosting stopped
2024-09-05 08:29:36.015 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 08:29:36.175 +07:00 [DBG] Hosting starting
2024-09-05 08:29:36.199 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 08:29:36.215 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 08:29:36.228 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 08:29:36.237 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 08:29:36.245 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 08:29:36.255 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 08:29:36.271 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:29:36.280 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 08:29:36.289 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:29:36.302 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 08:29:36.309 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 08:29:36.313 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 08:29:36.316 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 08:29:36.489 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 08:29:36.491 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 08:29:36.493 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 08:29:36.495 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 08:29:36.496 +07:00 [INF] Hosting environment: Development
2024-09-05 08:29:36.498 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 08:29:36.501 +07:00 [DBG] Hosting started
2024-09-05 08:29:41.750 +07:00 [DBG] Connection id "0HN6D98RJH6FN" accepted.
2024-09-05 08:29:41.758 +07:00 [DBG] Connection id "0HN6D98RJH6FN" started.
2024-09-05 08:29:41.758 +07:00 [DBG] Connection id "0HN6D98RJH6FO" accepted.
2024-09-05 08:29:41.766 +07:00 [DBG] Connection id "0HN6D98RJH6FO" started.
2024-09-05 08:29:41.829 +07:00 [DBG] Connection id "0HN6D98RJH6FO" received FIN.
2024-09-05 08:29:41.843 +07:00 [DBG] Connection 0HN6D98RJH6FO established using the following protocol: "Tls13"
2024-09-05 08:29:41.843 +07:00 [DBG] Connection 0HN6D98RJH6FN established using the following protocol: "Tls13"
2024-09-05 08:29:41.881 +07:00 [DBG] Connection id "0HN6D98RJH6FO" is closed. The last processed stream ID was 0.
2024-09-05 08:29:41.889 +07:00 [DBG] Connection id "0HN6D98RJH6FO" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:29:41.899 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FO completed.
2024-09-05 08:29:41.908 +07:00 [DBG] Connection id "0HN6D98RJH6FO" stopped.
2024-09-05 08:29:41.924 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 08:29:41.936 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-09-05 08:29:42.067 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 151.4599ms
2024-09-05 08:29:42.116 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/swagger-ui.css - null null
2024-09-05 08:29:42.120 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/swagger-ui-standalone-preset.js - null null
2024-09-05 08:29:42.120 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/swagger-ui-bundle.js - null null
2024-09-05 08:29:42.163 +07:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2024-09-05 08:29:42.163 +07:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2024-09-05 08:29:42.166 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/swagger-ui-standalone-preset.js - 200 339486 text/javascript 45.9816ms
2024-09-05 08:29:42.167 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/swagger-ui.css - 200 143943 text/css 51.003ms
2024-09-05 08:29:42.186 +07:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2024-09-05 08:29:42.189 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/swagger-ui-bundle.js - 200 1096145 text/javascript 69.1196ms
2024-09-05 08:29:42.569 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/favicon-32x32.png - null null
2024-09-05 08:29:42.575 +07:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2024-09-05 08:29:42.577 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/favicon-32x32.png - 200 628 image/png 8.9276ms
2024-09-05 08:29:42.841 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 08:29:43.080 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 238.926ms
2024-09-05 08:29:49.978 +07:00 [DBG] Connection id "0HN6D98RJH6FN" received FIN.
2024-09-05 08:29:49.982 +07:00 [DBG] Connection id "0HN6D98RJH6FN" is closed. The last processed stream ID was 11.
2024-09-05 08:29:49.982 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FN completed.
2024-09-05 08:29:49.987 +07:00 [DBG] Connection id "0HN6D98RJH6FN" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:29:50.008 +07:00 [DBG] Connection id "0HN6D98RJH6FN" stopped.
2024-09-05 08:29:56.651 +07:00 [DBG] Connection id "0HN6D98RJH6FP" accepted.
2024-09-05 08:29:56.655 +07:00 [DBG] Connection id "0HN6D98RJH6FP" started.
2024-09-05 08:29:56.664 +07:00 [DBG] Connection 0HN6D98RJH6FP established using the following protocol: "Tls13"
2024-09-05 08:29:56.671 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:29:56.679 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:29:56.707 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:29:56.715 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:29:56.727 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:29:56.790 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:29:56.796 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:29:56.821 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:29:56.830 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:29:56.834 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:29:56.840 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:29:56.846 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:29:56.850 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:29:56.860 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:29:57.029 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-09-05 08:29:57.056 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:29:57.853 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:29:57.923 +07:00 [DBG] Compiling query expression: 
'DbSet<Patient>()'
2024-09-05 08:29:58.135 +07:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Patient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Patient.PatientId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Patient.Avatar (string) Required, 1], [Property: Patient.Date (DateTime) Required, 2], [Property: Patient.Diseases (string) Required, 3], [Property: Patient.Email (string) Required, 4], [Property: Patient.FullName (string) Required, 5], [Property: Patient.Gender (string) Required, 6], [Property: Patient.Location (string) Required, 7], [Property: Patient.PaymentId (Guid?) FK Index, 8], [Property: Patient.PhoneNumber (string) Required, 9], [Property: Patient.Status (string) Required, 10] }
        SELECT p.PatientId, p.Avatar, p.Date, p.Diseases, p.Email, p.FullName, p.Gender, p.Location, p.PaymentId, p.PhoneNumber, p.Status
        FROM Patient AS p), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Patient>, 
    CityInfo.API.DbContexts.DoctorManagementContext, 
    False, 
    False, 
    True
)'
2024-09-05 08:29:58.175 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:29:58.204 +07:00 [DBG] Created DbConnection. (29ms).
2024-09-05 08:29:58.209 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:29:58.526 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:29:58.532 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:29:58.538 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2024-09-05 08:29:58.547 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (14ms).
2024-09-05 08:29:58.555 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:29:58.614 +07:00 [INF] Executed DbCommand (58ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:29:58.629 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:29:58.639 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 12ms reading results.
2024-09-05 08:29:58.645 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:29:58.653 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (8ms).
2024-09-05 08:29:58.662 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:29:58.670 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:29:58.672 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:29:58.674 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:29:58.678 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:29:58.683 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:29:58.774 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 1912.2874ms
2024-09-05 08:29:58.776 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:29:58.782 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:29:58.790 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:29:58.796 +07:00 [DBG] Disposed connection to database '' on server '' (5ms).
2024-09-05 08:29:58.798 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 2126.0388ms
2024-09-05 08:29:59.990 +07:00 [DBG] Connection id "0HN6D98RJH6FP" received FIN.
2024-09-05 08:29:59.996 +07:00 [DBG] Connection id "0HN6D98RJH6FP" is closed. The last processed stream ID was 1.
2024-09-05 08:29:59.997 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FP completed.
2024-09-05 08:30:00.003 +07:00 [DBG] Connection id "0HN6D98RJH6FP" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:30:00.019 +07:00 [DBG] Connection id "0HN6D98RJH6FP" stopped.
2024-09-05 08:30:47.321 +07:00 [DBG] Connection id "0HN6D98RJH6FQ" accepted.
2024-09-05 08:30:47.323 +07:00 [DBG] Connection id "0HN6D98RJH6FQ" started.
2024-09-05 08:30:47.330 +07:00 [DBG] Connection 0HN6D98RJH6FQ established using the following protocol: "Tls13"
2024-09-05 08:30:47.336 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:30:47.345 +07:00 [DBG] POST requests are not supported
2024-09-05 08:30:47.351 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:30:47.354 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:30:47.360 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:30:47.364 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:30:47.369 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:30:47.384 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:30:47.389 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:30:47.392 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:30:47.394 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:30:47.399 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:30:47.403 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:30:47.406 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:30:47.410 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:30:47.423 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:30:47.428 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:30:47.431 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:30:47.435 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:30:47.446 +07:00 [DBG] Connection id "0HN6D98RJH6FQ", Request id "0HN6D98RJH6FQ:00000001": started reading request body.
2024-09-05 08:30:47.449 +07:00 [DBG] Connection id "0HN6D98RJH6FQ", Request id "0HN6D98RJH6FQ:00000001": done reading request body.
2024-09-05 08:30:47.503 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:30:47.505 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:30:47.507 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:30:47.521 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:30:47.545 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:30:47.583 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:30:47.654 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:30:47.664 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:30:47.671 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:30:47.699 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:30:47.784 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:30:47.791 +07:00 [DBG] Created DbConnection. (7ms).
2024-09-05 08:30:47.795 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:30:47.800 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:30:47.808 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:30:47.810 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-09-05 08:30:47.817 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (9ms).
2024-09-05 08:30:47.825 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:30:47.916 +07:00 [ERR] Failed executing DbCommand (96ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:30:47.928 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:30:47.935 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (7ms).
2024-09-05 08:30:47.963 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:30:47.990 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:30:47.996 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:30:47.998 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:30:48.004 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:30:48.008 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:30:48.047 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 641.7659ms
2024-09-05 08:30:48.051 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:30:48.053 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:30:48.055 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:30:48.057 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2024-09-05 08:30:48.061 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 725.2102ms
2024-09-05 08:30:50.014 +07:00 [DBG] Connection id "0HN6D98RJH6FQ" received FIN.
2024-09-05 08:30:50.016 +07:00 [DBG] Connection id "0HN6D98RJH6FQ" is closed. The last processed stream ID was 1.
2024-09-05 08:30:50.016 +07:00 [DBG] Connection id "0HN6D98RJH6FQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:30:50.020 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FQ completed.
2024-09-05 08:30:50.023 +07:00 [DBG] Connection id "0HN6D98RJH6FQ" stopped.
2024-09-05 08:31:03.470 +07:00 [DBG] Connection id "0HN6D98RJH6FR" accepted.
2024-09-05 08:31:03.474 +07:00 [DBG] Connection id "0HN6D98RJH6FR" started.
2024-09-05 08:31:03.479 +07:00 [DBG] Connection 0HN6D98RJH6FR established using the following protocol: "Tls13"
2024-09-05 08:31:03.484 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:31:03.489 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:31:03.490 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:31:03.492 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:31:03.496 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:03.504 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:31:03.506 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:03.508 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:31:03.511 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:31:03.514 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:31:03.517 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:03.522 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:31:03.527 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:03.530 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:03.536 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:03.597 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:31:03.607 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:31:03.611 +07:00 [DBG] Created DbConnection. (4ms).
2024-09-05 08:31:03.614 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:03.617 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:03.621 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:31:03.624 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-09-05 08:31:03.627 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-09-05 08:31:03.630 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:31:03.646 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:31:03.650 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:03.654 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 3ms reading results.
2024-09-05 08:31:03.657 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:03.660 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (2ms).
2024-09-05 08:31:03.663 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:31:03.671 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:31:03.673 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:31:03.674 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:31:03.677 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:31:03.680 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:31:03.683 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 153.1698ms
2024-09-05 08:31:03.688 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:03.691 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:31:03.692 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:03.694 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2024-09-05 08:31:03.696 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 211.9795ms
2024-09-05 08:31:05.008 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:31:05.012 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:31:05.016 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:31:05.020 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:31:05.023 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:05.026 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:31:05.029 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:05.031 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:31:05.034 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:31:05.036 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:31:05.039 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:05.045 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:31:05.051 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:05.055 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:05.058 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:05.063 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:31:05.067 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:31:05.070 +07:00 [DBG] Created DbConnection. (3ms).
2024-09-05 08:31:05.072 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:05.076 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:05.082 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:31:05.085 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-09-05 08:31:05.091 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2024-09-05 08:31:05.094 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:31:05.107 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:31:05.112 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:05.115 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 2ms reading results.
2024-09-05 08:31:05.117 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:05.119 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (2ms).
2024-09-05 08:31:05.122 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:31:05.128 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:31:05.130 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:31:05.131 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:31:05.134 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:31:05.136 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:31:05.138 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 83.1344ms
2024-09-05 08:31:05.142 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:05.144 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:31:05.145 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:05.147 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2024-09-05 08:31:05.151 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 142.391ms
2024-09-05 08:31:05.995 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:31:05.999 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:31:06.000 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:31:06.002 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:31:06.006 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:06.010 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:31:06.012 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:06.014 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:31:06.018 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:31:06.021 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:31:06.024 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:06.029 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:31:06.033 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:06.038 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:06.043 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:06.048 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:31:06.050 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:31:06.052 +07:00 [DBG] Created DbConnection. (1ms).
2024-09-05 08:31:06.055 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:06.058 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:06.060 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:31:06.062 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2024-09-05 08:31:06.065 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2024-09-05 08:31:06.067 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:31:06.082 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:31:06.088 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:06.089 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 1ms reading results.
2024-09-05 08:31:06.092 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:06.095 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (2ms).
2024-09-05 08:31:06.098 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:31:06.103 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:31:06.104 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:31:06.106 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:31:06.107 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:31:06.109 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:31:06.111 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 73.3029ms
2024-09-05 08:31:06.113 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:31:06.115 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:31:06.117 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:06.120 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2024-09-05 08:31:06.124 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 128.5439ms
2024-09-05 08:31:10.055 +07:00 [DBG] Connection id "0HN6D98RJH6FR" received FIN.
2024-09-05 08:31:10.058 +07:00 [DBG] Connection id "0HN6D98RJH6FR" is closed. The last processed stream ID was 5.
2024-09-05 08:31:10.058 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FR completed.
2024-09-05 08:31:10.060 +07:00 [DBG] Connection id "0HN6D98RJH6FR" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:31:10.071 +07:00 [DBG] Connection id "0HN6D98RJH6FR" stopped.
2024-09-05 08:31:10.516 +07:00 [DBG] Connection id "0HN6D98RJH6FS" accepted.
2024-09-05 08:31:10.517 +07:00 [DBG] Connection id "0HN6D98RJH6FS" started.
2024-09-05 08:31:10.525 +07:00 [DBG] Connection 0HN6D98RJH6FS established using the following protocol: "Tls13"
2024-09-05 08:31:10.529 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:31:10.535 +07:00 [DBG] POST requests are not supported
2024-09-05 08:31:10.537 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:31:10.541 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:31:10.544 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:31:10.549 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:31:10.551 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:31:10.555 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:31:10.559 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:31:10.561 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:31:10.565 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:10.571 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:31:10.573 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:31:10.578 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:10.584 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:31:10.587 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:31:10.589 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:31:10.593 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:31:10.595 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:31:10.598 +07:00 [DBG] Connection id "0HN6D98RJH6FS", Request id "0HN6D98RJH6FS:00000001": started reading request body.
2024-09-05 08:31:10.602 +07:00 [DBG] Connection id "0HN6D98RJH6FS", Request id "0HN6D98RJH6FS:00000001": done reading request body.
2024-09-05 08:31:10.607 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:31:10.614 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:31:10.616 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:31:10.620 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:31:10.626 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:31:10.634 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:31:10.643 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:31:10.647 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:31:10.651 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:31:10.654 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:31:10.657 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:31:10.658 +07:00 [DBG] Created DbConnection. (0ms).
2024-09-05 08:31:10.660 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:10.662 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:10.664 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:31:10.665 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-09-05 08:31:10.669 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2024-09-05 08:31:10.671 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:31:10.692 +07:00 [ERR] Failed executing DbCommand (20ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:31:10.696 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:10.698 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (1ms).
2024-09-05 08:31:10.702 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:31:10.726 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:31:10.730 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:31:10.734 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:31:10.738 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:31:10.742 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:31:10.747 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 168.6447ms
2024-09-05 08:31:10.752 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:31:10.756 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:31:10.758 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:31:10.760 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2024-09-05 08:31:10.763 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 235.217ms
2024-09-05 08:32:10.113 +07:00 [DBG] Connection id "0HN6D98RJH6FS" received FIN.
2024-09-05 08:32:10.116 +07:00 [DBG] Connection id "0HN6D98RJH6FS" is closed. The last processed stream ID was 1.
2024-09-05 08:32:10.118 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FS completed.
2024-09-05 08:32:10.119 +07:00 [DBG] Connection id "0HN6D98RJH6FS" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:32:10.126 +07:00 [DBG] Connection id "0HN6D98RJH6FS" stopped.
2024-09-05 08:35:33.197 +07:00 [DBG] Connection id "0HN6D98RJH6FT" accepted.
2024-09-05 08:35:33.198 +07:00 [DBG] Connection id "0HN6D98RJH6FT" started.
2024-09-05 08:35:33.211 +07:00 [DBG] Connection 0HN6D98RJH6FT established using the following protocol: "Tls13"
2024-09-05 08:35:33.214 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:35:33.216 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:35:33.220 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:35:33.222 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:35:33.225 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:35:33.227 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:35:33.231 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:35:33.233 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:35:33.235 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:35:33.237 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:35:33.239 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:35:33.242 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:35:33.247 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:35:33.250 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:35:33.253 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:35:33.257 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:35:33.261 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:35:33.262 +07:00 [DBG] Created DbConnection. (0ms).
2024-09-05 08:35:33.263 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:33.264 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:33.266 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:35:33.269 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2024-09-05 08:35:33.272 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-09-05 08:35:33.275 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:35:33.282 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:35:33.284 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:33.285 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 0ms reading results.
2024-09-05 08:35:33.286 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:33.289 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (2ms).
2024-09-05 08:35:33.291 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:35:33.295 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:35:33.297 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:35:33.298 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:35:33.301 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:35:33.303 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:35:33.305 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 55.8547ms
2024-09-05 08:35:33.308 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:35:33.311 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:35:33.313 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:33.316 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2024-09-05 08:35:33.321 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 106.7056ms
2024-09-05 08:35:34.428 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:35:34.433 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:35:34.437 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:35:34.447 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:35:34.450 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:35:34.455 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:35:34.457 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:35:34.462 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:35:34.466 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:35:34.469 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:35:34.472 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:35:34.476 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:35:34.479 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:35:34.483 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:35:34.486 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:35:34.488 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:35:34.493 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:35:34.494 +07:00 [DBG] Created DbConnection. (0ms).
2024-09-05 08:35:34.495 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:34.498 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:34.503 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:35:34.508 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2024-09-05 08:35:34.510 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (7ms).
2024-09-05 08:35:34.513 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:35:34.520 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:35:34.526 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:34.527 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 1ms reading results.
2024-09-05 08:35:34.530 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:34.533 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (3ms).
2024-09-05 08:35:34.534 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:35:34.538 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:35:34.539 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:35:34.540 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:35:34.541 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:35:34.543 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:35:34.546 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 63.0964ms
2024-09-05 08:35:34.548 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:35:34.551 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:35:34.553 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:35:34.555 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2024-09-05 08:35:34.560 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 131.2914ms
2024-09-05 08:35:40.332 +07:00 [DBG] Connection id "0HN6D98RJH6FT" received FIN.
2024-09-05 08:35:40.335 +07:00 [DBG] Connection id "0HN6D98RJH6FT" is closed. The last processed stream ID was 3.
2024-09-05 08:35:40.336 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FT completed.
2024-09-05 08:35:40.339 +07:00 [DBG] Connection id "0HN6D98RJH6FT" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:35:40.347 +07:00 [DBG] Connection id "0HN6D98RJH6FT" stopped.
2024-09-05 08:36:22.108 +07:00 [DBG] Connection id "0HN6D98RJH6FU" accepted.
2024-09-05 08:36:22.111 +07:00 [DBG] Connection id "0HN6D98RJH6FU" started.
2024-09-05 08:36:22.119 +07:00 [DBG] Connection 0HN6D98RJH6FU established using the following protocol: "Tls13"
2024-09-05 08:36:22.132 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:36:22.136 +07:00 [DBG] POST requests are not supported
2024-09-05 08:36:22.137 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:36:22.140 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:36:22.145 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:36:22.148 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:36:22.152 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:36:22.155 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:36:22.160 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:36:22.165 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:36:22.170 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:36:22.179 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:36:22.183 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:36:22.187 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:36:22.193 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:36:22.195 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:36:22.198 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:36:22.202 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:36:22.204 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:36:22.207 +07:00 [DBG] Connection id "0HN6D98RJH6FU", Request id "0HN6D98RJH6FU:00000001": started reading request body.
2024-09-05 08:36:22.210 +07:00 [DBG] Connection id "0HN6D98RJH6FU", Request id "0HN6D98RJH6FU:00000001": done reading request body.
2024-09-05 08:36:22.215 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:36:22.218 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:36:22.220 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:36:22.223 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:36:22.227 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:36:22.231 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:36:22.235 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:36:22.238 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:36:22.241 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:36:22.243 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:36:22.246 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:36:22.247 +07:00 [DBG] Created DbConnection. (1ms).
2024-09-05 08:36:22.248 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:22.253 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:22.258 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:36:22.262 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2024-09-05 08:36:22.266 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (8ms).
2024-09-05 08:36:22.269 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:36:22.284 +07:00 [ERR] Failed executing DbCommand (14ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:36:22.289 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:22.292 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (2ms).
2024-09-05 08:36:22.296 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:36:22.317 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:36:22.325 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:36:22.327 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:36:22.331 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:36:22.333 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:36:22.336 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 148.3699ms
2024-09-05 08:36:22.338 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:36:22.339 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:36:22.341 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:22.345 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2024-09-05 08:36:22.348 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 216.0252ms
2024-09-05 08:36:23.702 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:36:23.704 +07:00 [DBG] POST requests are not supported
2024-09-05 08:36:23.705 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:36:23.706 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:36:23.709 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:36:23.724 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:36:23.728 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:36:23.730 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:36:23.733 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:36:23.738 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:36:23.741 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:36:23.750 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:36:23.753 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:36:23.756 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:36:23.760 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:36:23.762 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:36:23.765 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:36:23.770 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:36:23.773 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:36:23.776 +07:00 [DBG] Connection id "0HN6D98RJH6FU", Request id "0HN6D98RJH6FU:00000003": started reading request body.
2024-09-05 08:36:23.779 +07:00 [DBG] Connection id "0HN6D98RJH6FU", Request id "0HN6D98RJH6FU:00000003": done reading request body.
2024-09-05 08:36:23.782 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:36:23.784 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:36:23.787 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:36:23.793 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:36:23.799 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:36:23.803 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:36:23.806 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:36:23.808 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:36:23.811 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:36:23.815 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:36:23.817 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:36:23.819 +07:00 [DBG] Created DbConnection. (1ms).
2024-09-05 08:36:23.820 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:23.822 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:23.824 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:36:23.825 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-09-05 08:36:23.828 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (4ms).
2024-09-05 08:36:23.830 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:36:23.836 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:36:23.840 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:23.842 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (1ms).
2024-09-05 08:36:23.844 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:36:23.862 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:36:23.865 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:36:23.867 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:36:23.871 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:36:23.873 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:36:23.875 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 119.4186ms
2024-09-05 08:36:23.877 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:36:23.878 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:36:23.879 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:36:23.881 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2024-09-05 08:36:23.883 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 181.1523ms
2024-09-05 08:37:06.240 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:37:06.244 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:37:06.245 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:37:06.247 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:37:06.251 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:37:06.254 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:37:06.255 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:37:06.258 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:37:06.262 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:37:06.268 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:37:06.270 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:37:06.282 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:37:06.285 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:37:06.291 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:37:06.296 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:37:06.300 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:37:06.305 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:37:06.307 +07:00 [DBG] Created DbConnection. (2ms).
2024-09-05 08:37:06.309 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:06.313 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:06.316 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:37:06.317 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-09-05 08:37:06.320 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2024-09-05 08:37:06.323 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:37:06.330 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:37:06.335 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:06.336 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 1ms reading results.
2024-09-05 08:37:06.338 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:06.343 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (5ms).
2024-09-05 08:37:06.345 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:37:06.352 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:37:06.353 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:37:06.355 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:37:06.356 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:37:06.359 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:37:06.363 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 71.6398ms
2024-09-05 08:37:06.367 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:37:06.370 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:37:06.372 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:06.373 +07:00 [DBG] Disposed connection to database '' on server '' (1ms).
2024-09-05 08:37:06.376 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 136.3122ms
2024-09-05 08:37:13.376 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:37:13.379 +07:00 [DBG] POST requests are not supported
2024-09-05 08:37:13.381 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:37:13.384 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:37:13.387 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:37:13.390 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:37:13.394 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:37:13.396 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:37:13.400 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:37:13.403 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:37:13.406 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:37:13.409 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:37:13.415 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:37:13.422 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:37:13.426 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:37:13.430 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:37:13.434 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:37:13.439 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:37:13.443 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:37:13.446 +07:00 [DBG] Connection id "0HN6D98RJH6FU", Request id "0HN6D98RJH6FU:00000007": started reading request body.
2024-09-05 08:37:13.448 +07:00 [DBG] Connection id "0HN6D98RJH6FU", Request id "0HN6D98RJH6FU:00000007": done reading request body.
2024-09-05 08:37:13.453 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:37:13.456 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:37:13.459 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:37:13.462 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:37:13.467 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:37:13.472 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:37:13.475 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:37:13.478 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:37:13.481 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:37:13.484 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:37:13.488 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:37:13.489 +07:00 [DBG] Created DbConnection. (1ms).
2024-09-05 08:37:13.491 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:13.493 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:13.495 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:37:13.497 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-09-05 08:37:13.501 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (5ms).
2024-09-05 08:37:13.502 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:37:13.513 +07:00 [ERR] Failed executing DbCommand (11ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:37:13.516 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:13.518 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (1ms).
2024-09-05 08:37:13.523 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:bcdd900f-f78b-48e7-9f2c-8bad0fe9ee10
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:37:13.549 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:37:13.557 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:37:13.558 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:37:13.562 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:37:13.564 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:37:13.566 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 144.183ms
2024-09-05 08:37:13.570 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:37:13.573 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:37:13.575 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:13.579 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2024-09-05 08:37:13.581 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 205.4771ms
2024-09-05 08:37:29.345 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:37:29.350 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:37:29.352 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:37:29.354 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:37:29.358 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:37:29.360 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:37:29.362 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:37:29.365 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:37:29.369 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:37:29.372 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:37:29.374 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:37:29.379 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:37:29.381 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:37:29.384 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:37:29.388 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:37:29.393 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:37:29.397 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:37:29.398 +07:00 [DBG] Created DbConnection. (1ms).
2024-09-05 08:37:29.399 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:29.401 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:29.403 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:37:29.404 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-09-05 08:37:29.406 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2024-09-05 08:37:29.407 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:37:29.411 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:37:29.415 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:29.418 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 3ms reading results.
2024-09-05 08:37:29.421 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:29.422 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (1ms).
2024-09-05 08:37:29.424 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:37:29.431 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:37:29.433 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:37:29.434 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:37:29.436 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:37:29.438 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:37:29.440 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 55.8742ms
2024-09-05 08:37:29.442 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:37:29.444 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:37:29.446 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:37:29.448 +07:00 [DBG] Disposed connection to database '' on server '' (2ms).
2024-09-05 08:37:29.450 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 106.2974ms
2024-09-05 08:37:29.843 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/favicon.ico - null null
2024-09-05 08:37:29.847 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:37:29.849 +07:00 [DBG] No candidates found for the request path '/favicon.ico'
2024-09-05 08:37:29.852 +07:00 [DBG] Request did not match any endpoints
2024-09-05 08:37:29.856 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:37:29.857 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/favicon.ico - 404 0 null 13.7906ms
2024-09-05 08:37:29.863 +07:00 [INF] Request reached the end of the middleware pipeline without being handled by application code. Request path: GET https://localhost:7169/favicon.ico, Response status code: 404
2024-09-05 08:39:40.968 +07:00 [DBG] Connection id "0HN6D98RJH6FU" is closing.
2024-09-05 08:39:40.971 +07:00 [DBG] Connection id "0HN6D98RJH6FU" is closed. The last processed stream ID was 11.
2024-09-05 08:39:40.974 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FU completed.
2024-09-05 08:39:40.977 +07:00 [DBG] Connection id "0HN6D98RJH6FU" stopped.
2024-09-05 08:39:40.984 +07:00 [DBG] Connection id "0HN6D98RJH6FU" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:41:05.134 +07:00 [DBG] Connection id "0HN6D98RJH6FV" accepted.
2024-09-05 08:41:05.137 +07:00 [DBG] Connection id "0HN6D98RJH6FV" started.
2024-09-05 08:41:05.146 +07:00 [DBG] Connection 0HN6D98RJH6FV established using the following protocol: "Tls13"
2024-09-05 08:41:05.154 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 08:41:05.160 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 5.8371ms
2024-09-05 08:41:05.629 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 08:41:05.664 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 34.6525ms
2024-09-05 08:43:18.580 +07:00 [DBG] Connection id "0HN6D98RJH6FV" is closing.
2024-09-05 08:43:18.581 +07:00 [DBG] Connection id "0HN6D98RJH6FV" is closed. The last processed stream ID was 3.
2024-09-05 08:43:18.583 +07:00 [DBG] The connection queue processing loop for 0HN6D98RJH6FV completed.
2024-09-05 08:43:18.585 +07:00 [DBG] Connection id "0HN6D98RJH6FV" stopped.
2024-09-05 08:43:18.591 +07:00 [DBG] Connection id "0HN6D98RJH6FV" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:53:08.050 +07:00 [INF] Application is shutting down...
2024-09-05 08:53:08.052 +07:00 [DBG] Hosting stopping
2024-09-05 08:53:08.070 +07:00 [DBG] Hosting stopped
2024-09-05 08:53:21.422 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 08:53:21.598 +07:00 [DBG] Hosting starting
2024-09-05 08:53:21.623 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 08:53:21.639 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 08:53:21.650 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 08:53:21.659 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 08:53:21.668 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 08:53:21.680 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 08:53:21.690 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:53:21.695 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 08:53:21.702 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:53:21.714 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 08:53:21.720 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 08:53:21.727 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 08:53:21.732 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 08:53:21.886 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 08:53:21.888 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 08:53:21.891 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 08:53:21.893 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 08:53:21.895 +07:00 [INF] Hosting environment: Development
2024-09-05 08:53:21.896 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 08:53:21.898 +07:00 [DBG] Hosting started
2024-09-05 08:53:30.086 +07:00 [DBG] Connection id "0HN6D9M596S8L" accepted.
2024-09-05 08:53:30.093 +07:00 [DBG] Connection id "0HN6D9M596S8L" started.
2024-09-05 08:53:30.161 +07:00 [DBG] Connection 0HN6D9M596S8L established using the following protocol: "Tls13"
2024-09-05 08:53:30.219 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 08:53:30.228 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-09-05 08:53:30.346 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 131.9734ms
2024-09-05 08:53:31.015 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 08:53:31.274 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 259.3763ms
2024-09-05 08:53:40.660 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:53:40.671 +07:00 [DBG] POST requests are not supported
2024-09-05 08:53:40.699 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:53:40.707 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:53:40.721 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:53:40.759 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:53:40.769 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:53:40.792 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:53:40.803 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:53:40.811 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:53:40.817 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:53:40.823 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:53:40.827 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:53:40.835 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:53:40.931 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-09-05 08:53:40.952 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:53:40.962 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:53:40.970 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:53:40.975 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:53:40.981 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:53:40.992 +07:00 [DBG] Connection id "0HN6D9M596S8L", Request id "0HN6D9M596S8L:00000005": started reading request body.
2024-09-05 08:53:40.997 +07:00 [DBG] Connection id "0HN6D9M596S8L", Request id "0HN6D9M596S8L:00000005": done reading request body.
2024-09-05 08:53:41.083 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:53:41.087 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:53:41.091 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:53:41.102 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:53:41.825 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:53:41.875 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:53:41.964 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:53:41.976 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:53:41.985 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:53:42.010 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:53:42.100 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:53:42.135 +07:00 [DBG] Created DbConnection. (34ms).
2024-09-05 08:53:42.143 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:53:42.362 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:53:42.376 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:53:42.385 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2024-09-05 08:53:42.399 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (22ms).
2024-09-05 08:53:42.414 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:53:42.475 +07:00 [ERR] Failed executing DbCommand (66ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:53:42.486 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:53:42.497 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (8ms).
2024-09-05 08:53:42.519 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:c4c3c1fd-010b-44e2-8d66-98bce933df9c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:c4c3c1fd-010b-44e2-8d66-98bce933df9c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:53:42.551 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:53:42.562 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:53:42.569 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:53:42.575 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:53:42.579 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:53:42.632 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 1792.7839ms
2024-09-05 08:53:42.635 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:53:42.640 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:53:42.647 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:53:42.653 +07:00 [DBG] Disposed connection to database '' on server '' (5ms).
2024-09-05 08:53:42.658 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 1998.1791ms
2024-09-05 08:55:52.395 +07:00 [INF] Application is shutting down...
2024-09-05 08:55:52.396 +07:00 [DBG] Hosting stopping
2024-09-05 08:55:52.402 +07:00 [DBG] Connection id "0HN6D9M596S8L" is closing.
2024-09-05 08:55:52.403 +07:00 [DBG] Connection id "0HN6D9M596S8L" is closed. The last processed stream ID was 5.
2024-09-05 08:55:52.404 +07:00 [DBG] Connection id "0HN6D9M596S8L" received FIN.
2024-09-05 08:55:52.404 +07:00 [DBG] Connection id "0HN6D9M596S8L" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:55:52.405 +07:00 [DBG] The connection queue processing loop for 0HN6D9M596S8L completed.
2024-09-05 08:55:52.407 +07:00 [DBG] Connection id "0HN6D9M596S8L" stopped.
2024-09-05 08:55:52.410 +07:00 [DBG] Hosting stopped
2024-09-05 08:57:03.617 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 08:57:03.778 +07:00 [DBG] Hosting starting
2024-09-05 08:57:03.806 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 08:57:03.822 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 08:57:03.832 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 08:57:03.916 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 08:57:03.928 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 08:57:03.941 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 08:57:03.959 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:57:03.966 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 08:57:03.970 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:57:03.979 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 08:57:03.982 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 08:57:03.985 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 08:57:03.987 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 08:57:04.126 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 08:57:04.128 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 08:57:04.130 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 08:57:04.131 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 08:57:04.132 +07:00 [INF] Hosting environment: Development
2024-09-05 08:57:04.134 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 08:57:04.136 +07:00 [DBG] Hosting started
2024-09-05 08:57:04.543 +07:00 [DBG] Connection id "0HN6D9O56DSHL" accepted.
2024-09-05 08:57:04.548 +07:00 [DBG] Connection id "0HN6D9O56DSHL" started.
2024-09-05 08:57:04.609 +07:00 [DBG] Connection 0HN6D9O56DSHL established using the following protocol: "Tls13"
2024-09-05 08:57:04.654 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 08:57:04.659 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-09-05 08:57:04.774 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 126.2793ms
2024-09-05 08:57:05.377 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 08:57:05.635 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 257.871ms
2024-09-05 08:57:17.539 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:57:17.547 +07:00 [DBG] POST requests are not supported
2024-09-05 08:57:17.579 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:57:17.584 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:57:17.598 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:57:17.646 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:57:17.652 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:57:17.673 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:57:17.680 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:57:17.683 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:57:17.688 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:57:17.691 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:57:17.694 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:57:17.702 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:57:17.814 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-09-05 08:57:17.846 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:57:17.854 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:57:17.858 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:57:17.861 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:57:17.863 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:57:17.873 +07:00 [DBG] Connection id "0HN6D9O56DSHL", Request id "0HN6D9O56DSHL:00000005": started reading request body.
2024-09-05 08:57:17.875 +07:00 [DBG] Connection id "0HN6D9O56DSHL", Request id "0HN6D9O56DSHL:00000005": done reading request body.
2024-09-05 08:57:17.967 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:57:17.976 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:57:17.978 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:57:17.989 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:57:18.677 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:57:18.720 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:57:18.808 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:57:18.816 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:57:18.824 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:57:18.853 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:57:18.926 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:57:18.956 +07:00 [DBG] Created DbConnection. (28ms).
2024-09-05 08:57:18.962 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:19.179 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:19.191 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:57:19.203 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (10ms).
2024-09-05 08:57:19.217 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (25ms).
2024-09-05 08:57:19.230 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:57:19.298 +07:00 [ERR] Failed executing DbCommand (72ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:57:19.310 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:19.327 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (12ms).
2024-09-05 08:57:19.356 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:9b4272dc-51a9-4143-97a1-276d9da53f34
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:9b4272dc-51a9-4143-97a1-276d9da53f34
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:57:19.386 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:57:19.400 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:57:19.404 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:57:19.410 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:57:19.414 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:57:19.466 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 1765.2232ms
2024-09-05 08:57:19.471 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:57:19.477 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:57:19.490 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:19.498 +07:00 [DBG] Disposed connection to database '' on server '' (8ms).
2024-09-05 08:57:19.505 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 1965.89ms
2024-09-05 08:57:35.832 +07:00 [INF] Application is shutting down...
2024-09-05 08:57:35.832 +07:00 [DBG] Hosting stopping
2024-09-05 08:57:35.841 +07:00 [DBG] Connection id "0HN6D9O56DSHL" is closing.
2024-09-05 08:57:35.843 +07:00 [DBG] Connection id "0HN6D9O56DSHL" is closed. The last processed stream ID was 5.
2024-09-05 08:57:35.846 +07:00 [DBG] Connection id "0HN6D9O56DSHL" received FIN.
2024-09-05 08:57:35.847 +07:00 [DBG] The connection queue processing loop for 0HN6D9O56DSHL completed.
2024-09-05 08:57:35.847 +07:00 [DBG] Connection id "0HN6D9O56DSHL" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 08:57:35.863 +07:00 [DBG] Connection id "0HN6D9O56DSHL" stopped.
2024-09-05 08:57:35.871 +07:00 [DBG] Hosting stopped
2024-09-05 08:57:40.158 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 08:57:40.322 +07:00 [DBG] Hosting starting
2024-09-05 08:57:40.347 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 08:57:40.364 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 08:57:40.371 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 08:57:40.380 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 08:57:40.387 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 08:57:40.395 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 08:57:40.403 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:57:40.407 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 08:57:40.411 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 08:57:40.419 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 08:57:40.424 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 08:57:40.428 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 08:57:40.431 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 08:57:40.586 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 08:57:40.588 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 08:57:40.590 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 08:57:40.591 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 08:57:40.593 +07:00 [INF] Hosting environment: Development
2024-09-05 08:57:40.595 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 08:57:40.597 +07:00 [DBG] Hosting started
2024-09-05 08:57:41.916 +07:00 [DBG] Connection id "0HN6D9OGAR54T" accepted.
2024-09-05 08:57:41.922 +07:00 [DBG] Connection id "0HN6D9OGAR54T" started.
2024-09-05 08:57:41.993 +07:00 [DBG] Connection 0HN6D9OGAR54T established using the following protocol: "Tls13"
2024-09-05 08:57:42.048 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 08:57:42.055 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-09-05 08:57:42.192 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 149.3491ms
2024-09-05 08:57:42.505 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 08:57:42.751 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 246.4547ms
2024-09-05 08:57:44.034 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 08:57:44.044 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 10.236ms
2024-09-05 08:57:44.237 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 08:57:44.267 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 29.8487ms
2024-09-05 08:57:52.064 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/api/Patient - null null
2024-09-05 08:57:52.077 +07:00 [DBG] The request path  does not match the path filter
2024-09-05 08:57:52.103 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:57:52.113 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:57:52.131 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:57:52.165 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:57:52.174 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:57:52.194 +07:00 [INF] Route matched with {action = "GetAll", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAll() on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:57:52.204 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:57:52.212 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:57:52.217 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:57:52.223 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:57:52.226 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:57:52.235 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:57:52.332 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-09-05 08:57:52.355 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:57:53.118 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:57:53.155 +07:00 [DBG] Compiling query expression: 
'DbSet<Patient>()'
2024-09-05 08:57:53.333 +07:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Patient>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.QueryExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Patient.PatientId (Guid) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Patient.Avatar (string) Required, 1], [Property: Patient.Date (DateTime) Required, 2], [Property: Patient.Diseases (string) Required, 3], [Property: Patient.Email (string) Required, 4], [Property: Patient.FullName (string) Required, 5], [Property: Patient.Gender (string) Required, 6], [Property: Patient.Location (string) Required, 7], [Property: Patient.PaymentId (Guid?) FK Index, 8], [Property: Patient.PhoneNumber (string) Required, 9], [Property: Patient.Status (string) Required, 10] }
        SELECT p.PatientId, p.Avatar, p.Date, p.Diseases, p.Email, p.FullName, p.Gender, p.Location, p.PaymentId, p.PhoneNumber, p.Status
        FROM Patient AS p), 
    null, 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Patient>, 
    CityInfo.API.DbContexts.DoctorManagementContext, 
    False, 
    False, 
    True
)'
2024-09-05 08:57:53.366 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:57:53.395 +07:00 [DBG] Created DbConnection. (25ms).
2024-09-05 08:57:53.400 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:53.631 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:53.638 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:57:53.648 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (9ms).
2024-09-05 08:57:53.659 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (22ms).
2024-09-05 08:57:53.670 +07:00 [DBG] Executing DbCommand [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:57:53.720 +07:00 [INF] Executed DbCommand (51ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [p].[PatientId], [p].[Avatar], [p].[Date], [p].[Diseases], [p].[Email], [p].[FullName], [p].[Gender], [p].[Location], [p].[PaymentId], [p].[PhoneNumber], [p].[Status]
FROM [Patient] AS [p]
2024-09-05 08:57:53.733 +07:00 [DBG] Closing data reader to 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:53.749 +07:00 [DBG] A data reader for 'DoctorDatabase' on server '.\sqlexpress' is being disposed after spending 13ms reading results.
2024-09-05 08:57:53.760 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:53.775 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (14ms).
2024-09-05 08:57:53.787 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:57:53.802 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:57:53.806 +07:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2024-09-05 08:57:53.809 +07:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2024-09-05 08:57:53.814 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/json' to write the response.
2024-09-05 08:57:53.819 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[CityInfo.API.DbContexts.Patient, CityInfo.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2024-09-05 08:57:53.899 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API) in 1659.4712ms
2024-09-05 08:57:53.901 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.GetAll (CityInfo.API)'
2024-09-05 08:57:53.907 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:57:53.917 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:57:53.924 +07:00 [DBG] Disposed connection to database '' on server '' (7ms).
2024-09-05 08:57:53.927 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/api/Patient - 200 2 application/json; charset=utf-8 1862.4127ms
2024-09-05 08:58:07.228 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 08:58:07.232 +07:00 [DBG] POST requests are not supported
2024-09-05 08:58:07.239 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 08:58:07.243 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 08:58:07.248 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:58:07.255 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 08:58:07.256 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:58:07.270 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 08:58:07.276 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 08:58:07.279 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 08:58:07.284 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:58:07.290 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 08:58:07.296 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 08:58:07.298 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:58:07.305 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 08:58:07.314 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:58:07.321 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 08:58:07.332 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:58:07.335 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 08:58:07.345 +07:00 [DBG] Connection id "0HN6D9OGAR54T", Request id "0HN6D9OGAR54T:0000000B": started reading request body.
2024-09-05 08:58:07.350 +07:00 [DBG] Connection id "0HN6D9OGAR54T", Request id "0HN6D9OGAR54T:0000000B": done reading request body.
2024-09-05 08:58:07.401 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:58:07.407 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:58:07.412 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 08:58:07.424 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 08:58:07.451 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 08:58:07.484 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:58:07.569 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 08:58:07.577 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 08:58:07.586 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 08:58:07.612 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 08:58:07.689 +07:00 [DBG] Creating DbConnection.
2024-09-05 08:58:07.692 +07:00 [DBG] Created DbConnection. (3ms).
2024-09-05 08:58:07.693 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:58:07.699 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:58:07.705 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 08:58:07.711 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2024-09-05 08:58:07.723 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (18ms).
2024-09-05 08:58:07.730 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:58:07.764 +07:00 [ERR] Failed executing DbCommand (35ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 08:58:07.775 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:58:07.778 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (3ms).
2024-09-05 08:58:07.804 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:44d90d41-1b28-4ca7-aee0-ebeae7b0bea6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:44d90d41-1b28-4ca7-aee0-ebeae7b0bea6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 08:58:07.833 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 08:58:07.842 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 08:58:07.847 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 08:58:07.855 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 08:58:07.860 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 08:58:07.884 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 586.3024ms
2024-09-05 08:58:07.890 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 08:58:07.894 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 08:58:07.896 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 08:58:07.899 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2024-09-05 08:58:07.902 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 674.6898ms
2024-09-05 09:00:20.620 +07:00 [DBG] Connection id "0HN6D9OGAR54T" is closing.
2024-09-05 09:00:20.621 +07:00 [DBG] Connection id "0HN6D9OGAR54T" is closed. The last processed stream ID was 11.
2024-09-05 09:00:20.625 +07:00 [DBG] Connection id "0HN6D9OGAR54T" received FIN.
2024-09-05 09:00:20.626 +07:00 [DBG] The connection queue processing loop for 0HN6D9OGAR54T completed.
2024-09-05 09:00:20.628 +07:00 [DBG] Connection id "0HN6D9OGAR54T" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 09:00:20.636 +07:00 [DBG] Connection id "0HN6D9OGAR54T" stopped.
2024-09-05 09:01:24.648 +07:00 [DBG] Connection id "0HN6D9OGAR54U" accepted.
2024-09-05 09:01:24.652 +07:00 [DBG] Connection id "0HN6D9OGAR54U" started.
2024-09-05 09:01:24.666 +07:00 [DBG] Connection 0HN6D9OGAR54U established using the following protocol: "Tls13"
2024-09-05 09:01:24.673 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 278
2024-09-05 09:01:24.683 +07:00 [DBG] POST requests are not supported
2024-09-05 09:01:24.685 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 09:01:24.687 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 09:01:24.688 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:01:24.693 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 09:01:24.696 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:01:24.697 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 09:01:24.701 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 09:01:24.702 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 09:01:24.704 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 09:01:24.707 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 09:01:24.709 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 09:01:24.714 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 09:01:24.720 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 09:01:24.726 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 09:01:24.732 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 09:01:24.735 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 09:01:24.739 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 09:01:24.743 +07:00 [DBG] Connection id "0HN6D9OGAR54U", Request id "0HN6D9OGAR54U:00000001": started reading request body.
2024-09-05 09:01:24.744 +07:00 [DBG] Connection id "0HN6D9OGAR54U", Request id "0HN6D9OGAR54U:00000001": done reading request body.
2024-09-05 09:01:24.748 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:01:24.751 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:01:24.754 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 09:01:24.758 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:01:24.865 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 09:01:24.872 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 09:01:24.878 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 09:01:24.883 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 09:01:24.886 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 09:01:24.888 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 09:01:24.891 +07:00 [DBG] Creating DbConnection.
2024-09-05 09:01:24.892 +07:00 [DBG] Created DbConnection. (0ms).
2024-09-05 09:01:24.894 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:01:24.897 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:01:24.901 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 09:01:24.902 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2024-09-05 09:01:24.904 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (3ms).
2024-09-05 09:01:24.906 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 09:01:24.927 +07:00 [ERR] Failed executing DbCommand (21ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 09:01:24.934 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:01:24.938 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (3ms).
2024-09-05 09:01:24.942 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:44d90d41-1b28-4ca7-aee0-ebeae7b0bea6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:44d90d41-1b28-4ca7-aee0-ebeae7b0bea6
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 09:01:24.965 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 09:01:24.970 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 09:01:24.972 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 09:01:24.975 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 09:01:24.979 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 09:01:24.982 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 268.4896ms
2024-09-05 09:01:24.986 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:01:24.988 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 09:01:24.989 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:01:24.993 +07:00 [DBG] Disposed connection to database '' on server '' (3ms).
2024-09-05 09:01:24.994 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 320.7674ms
2024-09-05 09:03:36.783 +07:00 [INF] Application is shutting down...
2024-09-05 09:03:36.784 +07:00 [DBG] Hosting stopping
2024-09-05 09:03:36.794 +07:00 [DBG] Connection id "0HN6D9OGAR54U" is closing.
2024-09-05 09:03:36.798 +07:00 [DBG] Connection id "0HN6D9OGAR54U" is closed. The last processed stream ID was 1.
2024-09-05 09:03:36.802 +07:00 [DBG] Connection id "0HN6D9OGAR54U" received FIN.
2024-09-05 09:03:36.802 +07:00 [DBG] The connection queue processing loop for 0HN6D9OGAR54U completed.
2024-09-05 09:03:36.807 +07:00 [DBG] Connection id "0HN6D9OGAR54U" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 09:03:36.819 +07:00 [DBG] Connection id "0HN6D9OGAR54U" stopped.
2024-09-05 09:03:36.825 +07:00 [DBG] Hosting stopped
2024-09-05 09:03:40.615 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 09:03:40.953 +07:00 [DBG] Hosting starting
2024-09-05 09:03:40.979 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 09:03:41.005 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 09:03:41.013 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 09:03:41.019 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 09:03:41.025 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 09:03:41.034 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 09:03:41.039 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 09:03:41.043 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 09:03:41.046 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 09:03:41.054 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 09:03:41.057 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 09:03:41.060 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 09:03:41.062 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 09:03:41.226 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 09:03:41.228 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 09:03:41.229 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 09:03:41.231 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 09:03:41.232 +07:00 [INF] Hosting environment: Development
2024-09-05 09:03:41.233 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 09:03:41.234 +07:00 [DBG] Hosting started
2024-09-05 09:08:55.615 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" accepted.
2024-09-05 09:08:55.617 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" started.
2024-09-05 09:08:55.665 +07:00 [DBG] Connection 0HN6D9UP3NOBT established using the following protocol: "Tls13"
2024-09-05 09:08:55.700 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 09:08:55.709 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-09-05 09:08:55.801 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 104.1962ms
2024-09-05 09:08:56.180 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 09:08:56.368 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 187.9158ms
2024-09-05 09:09:04.923 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 09:09:04.927 +07:00 [DBG] POST requests are not supported
2024-09-05 09:09:04.950 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 09:09:04.955 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 09:09:04.964 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:09:04.989 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 09:09:04.993 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:09:05.013 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 09:09:05.023 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 09:09:05.028 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 09:09:05.036 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 09:09:05.039 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 09:09:05.042 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 09:09:05.049 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 09:09:05.133 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-09-05 09:09:05.159 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 09:09:05.169 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 09:09:05.179 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 09:09:05.183 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 09:09:05.189 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 09:09:05.198 +07:00 [DBG] Connection id "0HN6D9UP3NOBT", Request id "0HN6D9UP3NOBT:00000005": started reading request body.
2024-09-05 09:09:05.206 +07:00 [DBG] Connection id "0HN6D9UP3NOBT", Request id "0HN6D9UP3NOBT:00000005": done reading request body.
2024-09-05 09:09:05.284 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:09:05.291 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:09:05.296 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 09:09:05.305 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:09:05.859 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 09:09:05.898 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 09:09:05.980 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 09:09:05.987 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 09:09:05.995 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 09:09:06.018 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 09:09:06.092 +07:00 [DBG] Creating DbConnection.
2024-09-05 09:09:06.115 +07:00 [DBG] Created DbConnection. (24ms).
2024-09-05 09:09:06.122 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:06.309 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:06.321 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 09:09:06.330 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (8ms).
2024-09-05 09:09:06.346 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (26ms).
2024-09-05 09:09:06.361 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 09:09:06.421 +07:00 [ERR] Failed executing DbCommand (64ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 09:09:06.433 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:06.443 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (6ms).
2024-09-05 09:09:06.460 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:ec6349b3-ca1e-4257-99f9-c80cedd6e1f8
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:ec6349b3-ca1e-4257-99f9-c80cedd6e1f8
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 09:09:06.485 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 09:09:06.496 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 09:09:06.502 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 09:09:06.514 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 09:09:06.518 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 09:09:06.565 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 1513.1913ms
2024-09-05 09:09:06.570 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:09:06.575 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 09:09:06.584 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:06.592 +07:00 [DBG] Disposed connection to database '' on server '' (8ms).
2024-09-05 09:09:06.602 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 1678.4901ms
2024-09-05 09:09:34.722 +07:00 [INF] Application is shutting down...
2024-09-05 09:09:34.723 +07:00 [DBG] Hosting stopping
2024-09-05 09:09:34.728 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" is closing.
2024-09-05 09:09:34.729 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" is closed. The last processed stream ID was 5.
2024-09-05 09:09:34.730 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" received FIN.
2024-09-05 09:09:34.731 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 09:09:34.732 +07:00 [DBG] The connection queue processing loop for 0HN6D9UP3NOBT completed.
2024-09-05 09:09:34.737 +07:00 [DBG] Connection id "0HN6D9UP3NOBT" stopped.
2024-09-05 09:09:34.740 +07:00 [DBG] Hosting stopped
2024-09-05 09:09:37.138 +07:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.Versioning.ApiVersionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.TryParseModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2024-09-05 09:09:37.205 +07:00 [DBG] Hosting starting
2024-09-05 09:09:37.215 +07:00 [INF] User profile is available. Using 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2024-09-05 09:09:37.222 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-401a87b9-185b-4ae6-b430-e2cba568700e.xml'.
2024-09-05 09:09:37.228 +07:00 [DBG] Reading data from file 'C:\Users\giato\AppData\Local\ASP.NET\DataProtection-Keys\key-74288969-9a33-424a-9467-b5621ad6023e.xml'.
2024-09-05 09:09:37.232 +07:00 [DBG] Found key {401a87b9-185b-4ae6-b430-e2cba568700e}.
2024-09-05 09:09:37.234 +07:00 [DBG] Found key {74288969-9a33-424a-9467-b5621ad6023e}.
2024-09-05 09:09:37.239 +07:00 [DBG] Considering key {74288969-9a33-424a-9467-b5621ad6023e} with expiration date 2024-11-14 09:41:20Z as default key.
2024-09-05 09:09:37.241 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.XmlEncryption.DpapiXmlDecryptor, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 09:09:37.243 +07:00 [DBG] Decrypting secret element using Windows DPAPI.
2024-09-05 09:09:37.245 +07:00 [DBG] Forwarded activator type request from Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Version=8.0.0.0, Culture=neutral, PublicKeyToken=adb9793829ddae60 to Microsoft.AspNetCore.DataProtection.AuthenticatedEncryption.ConfigurationModel.AuthenticatedEncryptorDescriptorDeserializer, Microsoft.AspNetCore.DataProtection, Culture=neutral, PublicKeyToken=adb9793829ddae60
2024-09-05 09:09:37.247 +07:00 [DBG] Opening CNG algorithm 'AES' from provider 'null' with chaining mode CBC.
2024-09-05 09:09:37.249 +07:00 [DBG] Opening CNG algorithm 'SHA256' from provider 'null' with HMAC.
2024-09-05 09:09:37.250 +07:00 [DBG] Using key {74288969-9a33-424a-9467-b5621ad6023e} as the default key.
2024-09-05 09:09:37.251 +07:00 [DBG] Key ring with default key {74288969-9a33-424a-9467-b5621ad6023e} was loaded during application startup.
2024-09-05 09:09:37.310 +07:00 [INF] Now listening on: https://localhost:7169
2024-09-05 09:09:37.313 +07:00 [INF] Now listening on: http://localhost:5169
2024-09-05 09:09:37.314 +07:00 [DBG] Loaded hosting startup assembly CityInfo.API
2024-09-05 09:09:37.315 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2024-09-05 09:09:37.316 +07:00 [INF] Hosting environment: Development
2024-09-05 09:09:37.316 +07:00 [INF] Content root path: C:\Users\giato\Downloads\Workspace\.Net\CityInfo.API
2024-09-05 09:09:37.317 +07:00 [DBG] Hosting started
2024-09-05 09:09:39.680 +07:00 [DBG] Connection id "0HN6D9V67VH13" accepted.
2024-09-05 09:09:39.687 +07:00 [DBG] Connection id "0HN6D9V67VH13" started.
2024-09-05 09:09:39.739 +07:00 [DBG] Connection 0HN6D9V67VH13 established using the following protocol: "Tls13"
2024-09-05 09:09:39.777 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/index.html - null null
2024-09-05 09:09:39.792 +07:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2024-09-05 09:09:39.889 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/index.html - 200 null text/html;charset=utf-8 116.0406ms
2024-09-05 09:09:40.119 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - null null
2024-09-05 09:09:40.265 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7169/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 146.8346ms
2024-09-05 09:09:48.594 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7169/api/Patient - application/json-patch+json 281
2024-09-05 09:09:48.605 +07:00 [DBG] POST requests are not supported
2024-09-05 09:09:48.629 +07:00 [DBG] 1 candidate(s) found for the request path '/api/Patient'
2024-09-05 09:09:48.635 +07:00 [DBG] Endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)' with route pattern 'api/Patient' is valid for the request path '/api/Patient'
2024-09-05 09:09:48.642 +07:00 [DBG] Request matched endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:09:48.666 +07:00 [DBG] AuthenticationScheme: Bearer was not authenticated.
2024-09-05 09:09:48.669 +07:00 [INF] Executing endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:09:48.688 +07:00 [INF] Route matched with {action = "CreateNew", controller = "Patient"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult CreateNew(CityInfo.API.Models.PatientModel) on controller CityInfo.API.Controllers.PatientController (CityInfo.API).
2024-09-05 09:09:48.697 +07:00 [DBG] Execution plan of authorization filters (in the following order): ["None"]
2024-09-05 09:09:48.699 +07:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2024-09-05 09:09:48.703 +07:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 09:09:48.708 +07:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2024-09-05 09:09:48.714 +07:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)","Microsoft.AspNetCore.Mvc.ReportApiVersionsAttribute (Order: 0)"]
2024-09-05 09:09:48.723 +07:00 [DBG] Executing controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 09:09:48.791 +07:00 [DBG] An 'IServiceProvider' was created for internal use by Entity Framework.
2024-09-05 09:09:48.812 +07:00 [DBG] Executed controller factory for controller CityInfo.API.Controllers.PatientController (CityInfo.API)
2024-09-05 09:09:48.821 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 09:09:48.826 +07:00 [DBG] Attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel' using the name '' in request data ...
2024-09-05 09:09:48.837 +07:00 [DBG] Rejected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonPatchInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 09:09:48.840 +07:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonInputFormatter' for content type 'application/json-patch+json'.
2024-09-05 09:09:48.854 +07:00 [DBG] Connection id "0HN6D9V67VH13", Request id "0HN6D9V67VH13:00000005": started reading request body.
2024-09-05 09:09:48.856 +07:00 [DBG] Connection id "0HN6D9V67VH13", Request id "0HN6D9V67VH13:00000005": done reading request body.
2024-09-05 09:09:48.929 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:09:48.932 +07:00 [DBG] Done attempting to bind parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:09:48.934 +07:00 [DBG] Attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel' ...
2024-09-05 09:09:48.942 +07:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'CityInfo.API.Models.PatientModel'.
2024-09-05 09:09:49.466 +07:00 [DBG] Entity Framework Core 8.0.8 initialized 'DoctorManagementContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer:8.0.8' with options: None
2024-09-05 09:09:49.498 +07:00 [DBG] 'DoctorManagementContext' generated a value for the property 'Patient.PatientId'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 09:09:49.585 +07:00 [DBG] Context 'DoctorManagementContext' started tracking 'Patient' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2024-09-05 09:09:49.593 +07:00 [DBG] SaveChanges starting for 'DoctorManagementContext'.
2024-09-05 09:09:49.601 +07:00 [DBG] DetectChanges starting for 'DoctorManagementContext'.
2024-09-05 09:09:49.625 +07:00 [DBG] DetectChanges completed for 'DoctorManagementContext'.
2024-09-05 09:09:49.702 +07:00 [DBG] Creating DbConnection.
2024-09-05 09:09:49.732 +07:00 [DBG] Created DbConnection. (26ms).
2024-09-05 09:09:49.739 +07:00 [DBG] Opening connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:49.947 +07:00 [DBG] Opened connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:49.961 +07:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2024-09-05 09:09:49.974 +07:00 [DBG] Created DbCommand for 'ExecuteReader' (8ms).
2024-09-05 09:09:49.984 +07:00 [DBG] Initialized DbCommand for 'ExecuteReader' (23ms).
2024-09-05 09:09:49.998 +07:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 09:09:50.055 +07:00 [ERR] Failed executing DbCommand (60ms) [Parameters=[@p0='?' (DbType = Guid), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (Size = 4000), @p6='?' (Size = 4000), @p7='?' (Size = 4000), @p8='?' (DbType = Guid), @p9='?' (Size = 4000), @p10='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Patient] ([PatientId], [Avatar], [Date], [Diseases], [Email], [FullName], [Gender], [Location], [PaymentId], [PhoneNumber], [Status])
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10);
2024-09-05 09:09:50.068 +07:00 [DBG] Closing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:50.084 +07:00 [DBG] Closed connection to database 'DoctorDatabase' on server '.\sqlexpress' (11ms).
2024-09-05 09:09:50.103 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'CityInfo.API.DbContexts.DoctorManagementContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:5aca6c60-7b5f-4360-8e8a-8f9332a9ad1d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Patient_Payment_PaymentId". The conflict occurred in database "DoctorDatabase", table "dbo.Payment", column 'PaymentId'.
The statement has been terminated.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   at Microsoft.Data.SqlClient.SqlDataReader.get_MetaData()
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
ClientConnectionId:5aca6c60-7b5f-4360-8e8a-8f9332a9ad1d
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.Execute(IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.Execute(IEnumerable`1 commandBatches, IRelationalConnection connection)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChanges(IList`1 entries)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(IList`1 entriesToSave)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(StateManager stateManager, Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.<>c.<SaveChanges>b__112_0(DbContext _, ValueTuple`2 t)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChanges(Boolean acceptAllChangesOnSuccess)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChanges(Boolean acceptAllChangesOnSuccess)
2024-09-05 09:09:50.123 +07:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.XmlDataContractSerializerOutputFormatter"]
2024-09-05 09:09:50.132 +07:00 [DBG] No information found on request to perform content negotiation.
2024-09-05 09:09:50.135 +07:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2024-09-05 09:09:50.140 +07:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.NewtonsoftJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2024-09-05 09:09:50.147 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2024-09-05 09:09:50.192 +07:00 [INF] Executed action CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API) in 1468.6995ms
2024-09-05 09:09:50.196 +07:00 [INF] Executed endpoint 'CityInfo.API.Controllers.PatientController.CreateNew (CityInfo.API)'
2024-09-05 09:09:50.201 +07:00 [DBG] 'DoctorManagementContext' disposed.
2024-09-05 09:09:50.211 +07:00 [DBG] Disposing connection to database 'DoctorDatabase' on server '.\sqlexpress'.
2024-09-05 09:09:50.219 +07:00 [DBG] Disposed connection to database '' on server '' (6ms).
2024-09-05 09:09:50.224 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7169/api/Patient - 400 164 application/problem+json; charset=utf-8 1629.8247ms
2024-09-05 09:12:00.441 +07:00 [DBG] Connection id "0HN6D9V67VH13" is closing.
2024-09-05 09:12:00.445 +07:00 [DBG] Connection id "0HN6D9V67VH13" is closed. The last processed stream ID was 5.
2024-09-05 09:12:00.447 +07:00 [DBG] Connection id "0HN6D9V67VH13" received FIN.
2024-09-05 09:12:00.448 +07:00 [DBG] Connection id "0HN6D9V67VH13" sending FIN because: "The Socket transport's send loop completed gracefully."
2024-09-05 09:12:00.448 +07:00 [DBG] The connection queue processing loop for 0HN6D9V67VH13 completed.
2024-09-05 09:12:00.452 +07:00 [DBG] Connection id "0HN6D9V67VH13" stopped.
2024-09-05 09:12:04.687 +07:00 [INF] Application is shutting down...
2024-09-05 09:12:04.687 +07:00 [DBG] Hosting stopping
2024-09-05 09:12:04.702 +07:00 [DBG] Hosting stopped
